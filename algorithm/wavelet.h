/*
By qinshuo
2015.4.28

Note: The length of the signal must less than 80 points
	  Level of decompose is less than 6  
*/


#ifndef _WAVELET_H_
#define _WAVELET_H_

#include <stdlib.h>
#include <stdio.h>

#define BUFF_LEN 150

#ifdef __cplusplus
extern "C" {
#endif

	const int coif4_len = 24;
	const double coif4_Lo_D[] = {-0.00000178,-0.0000033,0.0000312,0.0000623,-0.000260,-0.000589,0.0012666,0.0037514,-0.005658,-0.015212,0.0250823,0.0393344,-0.096221,-0.066627,0.4343861,0.7822389,0.4153084,-0.056077,-0.081267,0.0266823,0.0160689,-0.007346,-0.001629,0.0008923	};
	const double coif4_Hi_D[] = {-0.0008923136685823146,-0.0016294920126017326 ,0.0073461663276420935,0.016068943964776348,-0.026682300156053072,-0.08126669968087875,0.05607731331675481 ,0.41530840703043026,-0.782238930920499,0.4343860564914685,0.06662747426342504,-0.09622044203398798,-0.03933442712333749,0.025082261844864097,0.015211731527946259,-0.00565828668661072,-0.003751436157278457,0.0012665619292989445,0.0005890207562443383,-0.00025997455248771324,-0.00006233903446100713  , 0.0000312298758653456,0.00000325968023688336,-0.000001784985003088261};
	const double coif4_Lo_R[] = {0.0008923136685823146,-0.0016294920126017326,-0.0073461663276420935,0.016068943964776348,0.026682300156053072,-0.08126669968087875,-0.05607731331675481,0.41530840703043026,0.782238930920499,0.4343860564914685,-0.06662747426342504,-0.09622044203398798,0.03933442712333749,0.025082261844864097,-0.015211731527946259,-0.00565828668661072,0.003751436157278457,0.0012665619292989445,-0.0005890207562443383,-0.00025997455248771324,0.00006233903446100713,0.000031229875865345646,-0.0000032596802368833675,-1.7849850030882614e-06};
	const double coif4_Hi_R[] = {-1.7849850030882614e-06,3.2596802368833675e-06		,3.1229875865345646e-05		,-6.233903446100713e-05		,-0.00025997455248771324		,0.0005890207562443383		,0.0012665619292989445		,-0.003751436157278457		,-0.00565828668661072		,0.015211731527946259		,0.025082261844864097		,-0.03933442712333749		,-0.09622044203398798		,0.06662747426342504		,0.4343860564914685		,-0.782238930920499		,0.41530840703043026		,0.05607731331675481		,-0.08126669968087875		,-0.026682300156053072		,0.016068943964776348		,0.0073461663276420935		,-0.0016294920126017326		,-0.0008923136685823146};
	
	const int coif5_len = 30;
	const double coif5_Lo_D[] = {-9.517657273819165E-08,-1.6744288576823017e-07,2.0637618513646814e-06		,3.7346551751414047e-06,-2.1315026809955787e-05,-4.134043227251251e-05,0.00014054114970203437		,0.00030225958181306315		,-0.0006381313430451114		,-0.0016628637020130838		,0.0024333732126576722		,0.006764185448053083		,-0.009164231162481846		,-0.01976177894257264		,0.03268357426711183		,0.0412892087501817		,-0.10557420870333893		,-0.06203596396290357		,0.4379916261718371		,0.7742896036529562		,0.4215662066908515		,-0.05204316317624377		,-0.09192001055969624		,0.02816802897093635		,0.023408156785839195		,-0.010131117519849788		,-0.004159358781386048		,0.0021782363581090178		,0.00035858968789573785		,-0.00021208083980379827};
	const double coif5_Hi_D[] = {0.00021208083980379827,0.00035858968789573785,-0.0021782363581090178		,-0.004159358781386048,0.010131117519849788,0.023408156785839195,-0.02816802897093635,-0.09192001055969624		,0.05204316317624377		,0.4215662066908515		,-0.7742896036529562		,0.4379916261718371		,0.06203596396290357		,-0.10557420870333893		,-0.0412892087501817		,0.03268357426711183		,0.01976177894257264		,-0.009164231162481846		,-0.006764185448053083		,0.0024333732126576722		,0.0016628637020130838		,-0.0006381313430451114		,-0.00030225958181306315		,0.00014054114970203437		,4.134043227251251e-05		,-2.1315026809955787e-05		,-3.7346551751414047e-06		,2.0637618513646814e-06		,1.6744288576823017e-07		,-9.517657273819165e-08	};
	const double coif5_Lo_R[] = {-0.00021208083980379827,0.00035858968789573785	,0.0021782363581090178	,-0.004159358781386048		,-0.010131117519849788		,0.023408156785839195		,0.02816802897093635		,-0.09192001055969624,-0.05204316317624377,0.4215662066908515	,0.7742896036529562,0.4379916261718371		,-0.06203596396290357		,-0.10557420870333893	,0.0412892087501817		,0.03268357426711183		,-0.01976177894257264		,-0.009164231162481846,0.006764185448053083,0.0024333732126576722,-0.0016628637020130838,-0.0006381313430451114,0.00030225958181306315,0.00014054114970203437,-4.134043227251251e-05,-2.1315026809955787e-05,3.7346551751414047e-06,2.0637618513646814e-06,-1.6744288576823017e-07,-9.517657273819165e-08};
	const double coif5_Hi_R[] = {-9.517657273819165e-08,1.6744288576823017e-07,2.0637618513646814e-06,-3.7346551751414047e-06,-2.1315026809955787e-05,4.134043227251251e-05,0.00014054114970203437,-0.00030225958181306315,-0.0006381313430451114,0.0016628637020130838,0.0024333732126576722,-0.006764185448053083,-0.009164231162481846,0.01976177894257264,0.03268357426711183,-0.0412892087501817,-0.10557420870333893,0.06203596396290357,0.4379916261718371,-0.7742896036529562,0.4215662066908515,0.05204316317624377,-0.09192001055969624,-0.02816802897093635,0.023408156785839195,0.010131117519849788,-0.004159358781386048,-0.0021782363581090178,0.00035858968789573785,0.00021208083980379827};

	const int db4_len = 8;
	const double db4_Lo_D[] = {-0.010597, 0.032883, 0.030841, -0.187035, -0.027984, 0.630881, 0.714847 ,0.230378};
	const double db4_Hi_D[] = {-0.230378, 0.714847, -0.630881, -0.027984, 0.187035, 0.030841, -0.032883, -0.010597};
	const double db4_Lo_R[] = {0.230378, 0.714847, 0.630881, -0.027984, -0.187035, 0.030841, 0.032883, -0.010597};
	const double db4_Hi_R[] = {-0.010597, -0.032883, 0.030841, 0.187035, -0.027984, -0.630881, 0.714847 ,-0.230378};

	const int db5_len = 10;
	const double db5_Lo_D[] = {0.003335725285001549	,-0.012580751999015526	,-0.006241490213011705		,0.07757149384006515		,-0.03224486958502952		,-0.24229488706619015		,0.13842814590110342		,0.7243085284385744		,0.6038292697974729		,0.160102397974125};	
	const double db5_Hi_D[] = {-0.160102397974125,0.6038292697974729,-0.7243085284385744,0.13842814590110342,0.24229488706619015,-0.03224486958502952,-0.07757149384006515,-0.006241490213011705,0.012580751999015526,0.003335725285001549};	
	const double db5_Lo_R[] = {0.160102397974125,0.6038292697974729,0.7243085284385744,0.13842814590110342,-0.24229488706619015,-0.03224486958502952,0.07757149384006515,-0.006241490213011705,-0.012580751999015526,0.003335725285001549};
	const double db5_Hi_R[] = {0.003335725285001549		,0.012580751999015526		,-0.006241490213011705		,-0.07757149384006515		,-0.03224486958502952		,0.24229488706619015		,0.13842814590110342		,-0.7243085284385744		,0.6038292697974729		,-0.160102397974125};

	const int db6_len = 12;
	const double db6_Lo_D[] = {-0.00107730108499558,0.004777257511010651,0.0005538422009938016,-0.031582039318031156,0.02752286553001629,0.09750160558707936,-0.12976686756709563,-0.22626469396516913,0.3152503517092432,0.7511339080215775,0.4946238903983854,0.11154074335008017};
	const double db6_Hi_D[] = {-0.11154074335008017,0.4946238903983854,-0.7511339080215775,0.3152503517092432,0.22626469396516913,-0.12976686756709563,-0.09750160558707936,0.02752286553001629,0.031582039318031156,0.0005538422009938016,-0.004777257511010651,-0.00107730108499558};
	const double db6_Lo_R[] = {0.11154074335008017,	0.4946238903983854,	0.7511339080215775,	0.3152503517092432,-0.22626469396516913,-0.12976686756709563,0.09750160558707936,0.02752286553001629,-0.031582039318031156,0.0005538422009938016,0.004777257511010651,-0.00107730108499558};
	const double db6_Hi_R[] = {-0.00107730108499558,-0.004777257511010651,0.0005538422009938016,0.031582039318031156,0.02752286553001629,-0.09750160558707936,-0.12976686756709563,0.22626469396516913,0.3152503517092432,-0.7511339080215775,0.4946238903983854,-0.11154074335008017};

	const int sym4_len = 8;
	const double sym4_Lo_D[] = {-0.07576571478927333,-0.02963552764599851,0.49761866763201545,0.8037387518059161,0.29785779560527736,-0.09921954357684722,-0.012603967262037833,0.0322231006040427};
	const double sym4_Hi_D[] = {-0.0322231006040427,-0.012603967262037833,0.09921954357684722,0.29785779560527736,-0.8037387518059161,0.49761866763201545,0.02963552764599851,-0.07576571478927333};
	const double sym4_Lo_R[] = {0.0322231006040427,-0.012603967262037833,-0.09921954357684722,0.29785779560527736,0.8037387518059161,0.49761866763201545,-0.02963552764599851,-0.07576571478927333};
	const double sym4_Hi_R[] = {-0.07576571478927333,0.02963552764599851,0.49761866763201545,-0.8037387518059161,0.29785779560527736,0.09921954357684722,-0.012603967262037833,-0.0322231006040427};

	const int sym5_len = 10;
	const double sym5_Lo_D[] = {0.027333068345077982,0.029519490925774643,-0.039134249302383094,0.1993975339773936,0.7234076904024206,0.6339789634582119,0.01660210576452232,-0.17532808990845047,-0.021101834024758855,0.019538882735286728};
	const double sym5_Hi_D[] = {-0.019538882735286728,-0.021101834024758855,0.17532808990845047,0.01660210576452232,-0.6339789634582119,0.7234076904024206,-0.1993975339773936,-0.039134249302383094,-0.029519490925774643,0.027333068345077982}; 
	const double sym5_Lo_R[] = {0.019538882735286728,-0.021101834024758855,-0.17532808990845047,0.01660210576452232,0.6339789634582119,0.7234076904024206,0.1993975339773936,-0.039134249302383094,0.029519490925774643,0.027333068345077982};
	const double sym5_Hi_R[] = {0.027333068345077982,-0.029519490925774643,-0.039134249302383094,-0.1993975339773936,0.7234076904024206,-0.6339789634582119,0.01660210576452232,0.17532808990845047,-0.021101834024758855,-0.019538882735286728};

	const int sym6_len = 12;
	const double sym6_Lo_D[] = {0.015404109327027373,0.0034907120842174702,-0.11799011114819057,-0.048311742585633,0.4910559419267466,0.787641141030194,0.3379294217276218,-0.07263752278646252,-0.021060292512300564,0.04472490177066578,0.0017677118642428036,-0.007800708325034148};
	const double sym6_Hi_D[] = {0.007800708325034148,0.0017677118642428036,-0.04472490177066578,-0.021060292512300564,0.07263752278646252,0.3379294217276218,-0.787641141030194,0.4910559419267466,0.048311742585633,-0.11799011114819057,-0.0034907120842174702,0.015404109327027373};
	const double sym6_Lo_R[] = {-0.007800708325034148,0.0017677118642428036,0.04472490177066578,-0.021060292512300564,-0.07263752278646252,0.3379294217276218,0.787641141030194,0.4910559419267466,-0.048311742585633,-0.11799011114819057,0.0034907120842174702,0.015404109327027373};
	const double sym6_Hi_R[] = {0.015404109327027373,-0.0034907120842174702,-0.11799011114819057,0.048311742585633,0.4910559419267466,-0.787641141030194,0.3379294217276218,0.07263752278646252,-0.021060292512300564,-0.04472490177066578,0.0017677118642428036,0.007800708325034148};

	// Compute coefficients of approximation.
	typedef struct 
	{
		int length;
		double capp[100];
		double cdet[100];
	} WaveCoeff;

	typedef struct
	{
		int length;
		double capp[100];
		double cdet[100];
	} WaveRecon;

	//down sample function
	void DownSample(double* signal,int sig_length,double* result);
	//up sample function
	void UpSample(double* signal,int sig_length,double* result);
	//create wavelet filters
	void CreateDB4(double*,int*);

	//extend array in the front and end
	void WExtend(double* init_signal,int init_len,double* dest_signal,int ext_len,double* fore_ext,double* back_ext);
	//basic convolution function
	void WConvolve(double* signal, int lenSignal, const double* filter, int lenFilter,double* result,double* fore_ext,double* back_ext);
	//discrete wavelet transform
	void DWT(double* signal,int sig_len, const double* Lo_D,int low_len, const double* Hi_D,int hig_len ,WaveCoeff* coeff,		 double* fore_ext,double* back_ext);
	//multi level wavelet transform
	void WaveDecompose(double* signal,int sig_len, const double* Lo_D,int low_len, const double* Hi_D,int hig_len,WaveCoeff* para_comtainer,int de_level);
	
	void IWConvolve(double* signal, int lenSignal, const double* filter, int lenFilter, double* result);
	//discrete wavelet inverse transform for one level
	void IDWT(double* signal,int sig_len, const double* filter,int filter_len,double* result,int result_len);
	//re-construct the wave for a specified level
	void WaveReconstruct(double* signal,int sig_len, const double* Lo_R,int low_len, const double* Hi_R,int hig_len ,WaveCoeff* coeff,WaveRecon* recon,const char mode,int level);
	

#ifdef __cplusplus
}
#endif

#endif


